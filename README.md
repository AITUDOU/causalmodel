# å› æœæ¨ç†åˆ†æç³»ç»Ÿ (Causal Inference Analysis System)

[![Python 3.8+](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)

## ğŸ“‹ é¡¹ç›®ç®€ä»‹

æœ¬é¡¹ç›®æä¾›äº†ä¸€å¥—å®Œæ•´çš„**å› æœæ¨ç†åˆ†ææ¡†æ¶**ï¼Œåº”ç”¨äºå·¥ä¸šåœºæ™¯çš„æ•°æ®é©±åŠ¨å†³ç­–ã€‚åŸºäº DoWhy å’Œ EconML ç­‰å› æœæ¨ç†åº“ï¼Œå®ç°äº†ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š

- ğŸ¯ **å› æœå›¾æ„å»º**ï¼šåŸºäºé¢†åŸŸçŸ¥è¯†å»ºç«‹å˜é‡é—´å› æœå…³ç³»
- ğŸ“Š **å½’å› åˆ†æ**ï¼šè¯†åˆ«ç»“æœå˜åŒ–çš„æ ¹æœ¬åŸå› 
- ğŸ”¬ **å¹²é¢„åˆ†æ**ï¼šè¯„ä¼°ä¸åŒä¼˜åŒ–æªæ–½çš„å› æœæ•ˆåº”
- ğŸ”® **åäº‹å®åˆ†æ**ï¼šå›ç­”"å¦‚æœå½“æ—¶åšäº†ä¸åŒé€‰æ‹©ä¼šæ€æ ·"çš„é—®é¢˜

### ğŸ­ åº”ç”¨åœºæ™¯

1. **æ··å‡åœŸé›†æ–™è´¨é‡æ§åˆ¶**ï¼šä¼˜åŒ–é…åˆæ¯”å’Œå·¥è‰ºå‚æ•°ï¼Œæå‡æ··å‡åœŸå¼ºåº¦
2. **å·¥ç¨‹æ£€æµ‹è´¨é‡ç®¡ç†**ï¼šè¯†åˆ«å½±å“æ£€æµ‹åˆæ ¼ç‡çš„å…³é”®å› ç´ ï¼Œä¼˜åŒ–æ£€æµ‹æµç¨‹

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒé…ç½®

```bash
# å…‹éš†é¡¹ç›®
git clone <repository_url>
cd causalmodel

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆæ¨èï¼‰
python -m venv venv
source venv/bin/activate  # Linux/Mac
# æˆ–
venv\Scripts\activate  # Windows

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### 2. è¿è¡Œç¤ºä¾‹

#### åœºæ™¯ä¸€ï¼šæ··å‡åœŸé›†æ–™åˆ†æ

```bash
# å½’å› åˆ†æ + å¹²é¢„åˆ†æ
python concrete_causal_demo.py

# åäº‹å®åˆ†æï¼ˆéœ€å…ˆè¿è¡Œä¸Šé¢çš„è„šæœ¬ç”Ÿæˆå› æœæ¨¡å‹ï¼‰
python concrete_counterfactual_demo.py
```

**è¾“å‡ºæ–‡ä»¶**ï¼š
- `results/figures/concrete_causal_graph.png` - å› æœå›¾
- `results/figures/attribution_analysis_concrete.png` - å½’å› åˆ†æ
- `results/figures/intervention_analysis_concrete.png` - å¹²é¢„åˆ†æ
- `results/figures/concrete_counterfactual_analysis.png` - åäº‹å®å¯¹æ¯”
- `results/reports/analysis_summary_concrete.txt` - åˆ†ææŠ¥å‘Š

#### åœºæ™¯äºŒï¼šå·¥ç¨‹æ£€æµ‹åˆ†æ

```bash
cd engineering_inspection_analysis

# è¿è¡Œå®Œæ•´åˆ†ææµç¨‹
python inspection_analysis_demo.py
```

**è¾“å‡ºæ–‡ä»¶**ï¼š
- `results/figures/inspection_causal_graph.png` - å› æœå›¾
- `results/figures/attribution_analysis.png` - å½’å› åˆ†æ
- `results/figures/intervention_analysis.png` - å¹²é¢„åˆ†æ
- `results/reports/analysis_summary.txt` - åˆ†ææŠ¥å‘Š

---

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
causalmodel/
â”œâ”€â”€ README.md                           # æœ¬æ–‡æ¡£
â”œâ”€â”€ requirements.txt                    # Pythonä¾èµ–
â”‚
â”œâ”€â”€ data/                               # æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ raw/                            # åŸå§‹æ•°æ®
â”‚   â”‚   â””â”€â”€ raw_data.xlsx
â”‚   â”œâ”€â”€ processed/                      # æ¸…æ´—åæ•°æ®
â”‚   â”‚   â””â”€â”€ cleaned_data.csv
â”‚   â””â”€â”€ synthetic/                      # åˆæˆæ•°æ®
â”‚       â””â”€â”€ concrete_aggregate_data.csv
â”‚
â”œâ”€â”€ src/                                # æ ¸å¿ƒä»£ç 
â”‚   â”œâ”€â”€ causal_model.py                 # å› æœæ¨¡å‹ç±»ï¼ˆæ··å‡åœŸåœºæ™¯ï¼‰
â”‚   â”œâ”€â”€ concrete_data_generator.py      # æ•°æ®ç”Ÿæˆå·¥å…·
â”‚   â”œâ”€â”€ data_cleaning.py                # æ•°æ®æ¸…æ´—
â”‚   â”œâ”€â”€ visualization.py                # å¯è§†åŒ–å·¥å…·
â”‚   â””â”€â”€ utils.py                        # å·¥å…·å‡½æ•°
â”‚
â”œâ”€â”€ concrete_causal_demo.py             # ã€æ¼”ç¤º1ã€‘æ··å‡åœŸå½’å› +å¹²é¢„åˆ†æ
â”œâ”€â”€ concrete_counterfactual_demo.py     # ã€æ¼”ç¤º2ã€‘æ··å‡åœŸåäº‹å®åˆ†æ
â”œâ”€â”€ counterfactual_analysis.py          # åäº‹å®åˆ†æé€šç”¨æ¨¡å—
â”œâ”€â”€ visualize_chinese_graph.py          # ä¸­æ–‡å› æœå›¾å¯è§†åŒ–
â”‚
â”œâ”€â”€ engineering_inspection_analysis/    # å·¥ç¨‹æ£€æµ‹åˆ†æå­é¡¹ç›®
â”‚   â”œâ”€â”€ README.md                       # å­é¡¹ç›®è¯´æ˜
â”‚   â”œâ”€â”€ requirements.txt                # å­é¡¹ç›®ä¾èµ–
â”‚   â”œâ”€â”€ inspection_analysis_demo.py     # ã€æ¼”ç¤º3ã€‘æ£€æµ‹å½’å› +å¹²é¢„+åäº‹å®
â”‚   â”œâ”€â”€ quick_test.py                   # å¿«é€Ÿæµ‹è¯•è„šæœ¬
â”‚   â”‚
â”‚   â”œâ”€â”€ data/                           # æ£€æµ‹æ•°æ®
â”‚   â”‚   â””â”€â”€ inspection_data_processed.csv
â”‚   â”‚
â”‚   â”œâ”€â”€ src/                            # æ£€æµ‹åˆ†æä»£ç 
â”‚   â”‚   â”œâ”€â”€ data_preprocessing.py       # æ•°æ®é¢„å¤„ç†
â”‚   â”‚   â”œâ”€â”€ inspection_causal_model.py  # æ£€æµ‹å› æœæ¨¡å‹
â”‚   â”‚   â””â”€â”€ visualization.py            # å¯è§†åŒ–å·¥å…·
â”‚   â”‚
â”‚   â””â”€â”€ results/                        # æ£€æµ‹åˆ†æç»“æœ
â”‚       â”œâ”€â”€ figures/                    # å›¾è¡¨
â”‚       â””â”€â”€ reports/                    # æŠ¥å‘Š
â”‚
â”œâ”€â”€ results/                            # æ··å‡åœŸåˆ†æç»“æœ
â”‚   â”œâ”€â”€ figures/                        # å›¾è¡¨
â”‚   â””â”€â”€ reports/                        # æŠ¥å‘Š
â”‚
â””â”€â”€ notebooks/                          # Jupyter notebooksï¼ˆå¯é€‰ï¼‰
```

---

## ğŸ“ æ ¸å¿ƒæ¦‚å¿µ

### 1. å› æœå›¾ (Causal Graph)

å› æœå›¾æ˜¯ä¸€ä¸ª**æœ‰å‘æ— ç¯å›¾ (DAG)**ï¼Œæè¿°å˜é‡ä¹‹é—´çš„å› æœå…³ç³»ï¼š
- **èŠ‚ç‚¹**ï¼šå˜é‡ï¼ˆå¦‚å«æ³¥é‡ã€æ°´èƒ¶æ¯”ã€æ··å‡åœŸå¼ºåº¦ï¼‰
- **è¾¹**ï¼šå› æœå…³ç³»ï¼ˆA â†’ B è¡¨ç¤º A å› æœå½±å“ Bï¼‰

**ç¤ºä¾‹**ï¼š
```
å«æ³¥é‡ â†’ æ··å‡åœŸå¼ºåº¦ â† æ°´èƒ¶æ¯”
   â†“            â†‘
æ³¥å—å«é‡    é…åˆæ¯”å‡†ç¡®æ€§
```

### 2. å½’å› åˆ†æ (Attribution Analysis)

**å›ç­”é—®é¢˜**ï¼šç»“æœå˜åŒ–çš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿ

**æ–¹æ³•**ï¼š
- æ¯”è¾ƒä¸¤ä¸ªæ—¶æœŸçš„æ•°æ®ï¼ˆå¦‚ä¼˜åŒ–å‰ vs ä¼˜åŒ–åï¼‰
- åˆ†è§£å˜åŒ–ï¼š`æ€»å˜åŒ– = Î£ (å„å˜é‡çš„è´¡çŒ®)`

**ç¤ºä¾‹è¾“å‡º**ï¼š
```
æ··å‡åœŸå¼ºåº¦æå‡ +5.2 MPaï¼Œå½’å› ä¸ºï¼š
  - å«æ³¥é‡é™ä½ï¼š+3.8 MPa (73%)
  - æ°´èƒ¶æ¯”ä¼˜åŒ–ï¼š+1.2 MPa (23%)
  - å…¶ä»–å› ç´ ï¼š+0.2 MPa (4%)
```

### 3. å¹²é¢„åˆ†æ (Intervention Analysis)

**å›ç­”é—®é¢˜**ï¼šå¦‚æœæ”¹å˜æŸä¸ªå˜é‡ï¼Œç»“æœä¼šå¦‚ä½•ï¼Ÿ

**æ–¹æ³•**ï¼š
- ä½¿ç”¨ do-calculus è®¡ç®—å¹²é¢„æ•ˆåº”ï¼š`P(Y | do(X=x))`
- é€šè¿‡å› æœå›¾æ¶ˆé™¤æ··æ‚åå·®

**ç¤ºä¾‹è¾“å‡º**ï¼š
```
å¹²é¢„æªæ–½æ•ˆæœæ’åï¼š
  1. å«æ³¥é‡é™ä½1%ï¼šå¼ºåº¦ +2.5 MPa â­
  2. æ°´èƒ¶æ¯”é™ä½0.01ï¼šå¼ºåº¦ +1.8 MPa
  3. æé«˜é…åˆæ¯”å‡†ç¡®æ€§1%ï¼šå¼ºåº¦ +0.6 MPa
```

### 4. åäº‹å®åˆ†æ (Counterfactual Analysis)

**å›ç­”é—®é¢˜**ï¼šå¦‚æœå½“æ—¶åšäº†ä¸åŒçš„é€‰æ‹©ï¼Œç»“æœä¼šæ€æ ·ï¼Ÿ

**æ–¹æ³•**ï¼š
- åŸºäºè§‚æµ‹æ•°æ®ï¼Œä½¿ç”¨å¯é€†å› æœæ¨¡å‹ï¼ˆNormalizing Flowï¼‰
- æ¨æ–­"å¹³è¡Œä¸–ç•Œ"ä¸­çš„ç»“æœ

**ç¤ºä¾‹è¾“å‡º**ï¼š
```
å®é™…æƒ…å†µï¼šå«æ³¥é‡ 3.5%ï¼Œå¼ºåº¦ 28.5 MPaï¼ˆä¸è¾¾æ ‡ï¼‰
åäº‹å®ï¼šå¦‚æœé‡‡ç”¨æ°´æ´—å·¥è‰ºé™è‡³ 1.0%ï¼Œå¼ºåº¦ä¼šè¾¾åˆ° 33.2 MPaï¼ˆè¾¾æ ‡ï¼‰âœ“
```

---

## ğŸ“– è¯¦ç»†ä½¿ç”¨æŒ‡å—

### åœºæ™¯ä¸€ï¼šæ··å‡åœŸé›†æ–™å› æœåˆ†æ

#### æ•°æ®å‡†å¤‡

ä½¿ç”¨åˆæˆæ•°æ®ï¼ˆå·²åŒ…å«åœ¨é¡¹ç›®ä¸­ï¼‰ï¼š
```python
# æ•°æ®è·¯å¾„ï¼šdata/synthetic/concrete_aggregate_data.csv
# åŒ…å«å˜é‡ï¼š
# - é›†æ–™å±æ€§ï¼šaggregate_type, origin, material_density, crushing_value...
# - è´¨é‡æŒ‡æ ‡ï¼šmud_content_pct, clay_lump_pct, flaky_particle_pct...
# - é…åˆæ¯”ï¼šwater_binder_ratio, sand_rate, mix_design_accuracy_pct...
# - ç»“æœå˜é‡ï¼šconcrete_strength_mpa, quality_pass
```

#### æ­¥éª¤ 1ï¼šå½’å› åˆ†æ

**åœºæ™¯**ï¼šå·¥è‰ºä¼˜åŒ–åæ··å‡åœŸå¼ºåº¦æå‡ï¼Œæ‰¾å‡ºä¸»è¦è´¡çŒ®å› ç´ 

```bash
python concrete_causal_demo.py
```

**è¾“å‡ºè§£è¯»**ï¼š
```
ä¸»è¦è´¡çŒ®å› ç´ ï¼ˆTop 10ï¼‰:
  mud_content_pct: -0.3850 (CI: [-0.4200, -0.3500])  # å«æ³¥é‡é™ä½è´¡çŒ®æœ€å¤§
  water_binder_ratio: -0.2100 (CI: [-0.2400, -0.1800])
  mix_design_accuracy_pct: +0.1520 (CI: [+0.1200, +0.1800])
  ...
```

- **è´Ÿå€¼**ï¼šè¯¥å˜é‡å€¼é™ä½å¯¼è‡´å¼ºåº¦æå‡ï¼ˆå¦‚å«æ³¥é‡é™ä½ï¼‰
- **æ­£å€¼**ï¼šè¯¥å˜é‡å€¼æå‡å¯¼è‡´å¼ºåº¦æå‡ï¼ˆå¦‚é…åˆæ¯”å‡†ç¡®æ€§æé«˜ï¼‰
- **CI**ï¼šç½®ä¿¡åŒºé—´ï¼Œåæ˜ ä¼°è®¡çš„ä¸ç¡®å®šæ€§

#### æ­¥éª¤ 2ï¼šå¹²é¢„åˆ†æ

**åœºæ™¯**ï¼šè¯„ä¼°ä¸åŒä¼˜åŒ–æªæ–½çš„é¢„æœŸæ•ˆæœ

```bash
# åœ¨ concrete_causal_demo.py ä¸­å·²åŒ…å«
```

**è¾“å‡ºè§£è¯»**ï¼š
```
æœ€æœ‰æ•ˆçš„ä¼˜åŒ–æªæ–½ï¼ˆTop 10ï¼‰:
  mud_content_pct: -2.5000 MPa (CI: [-2.8000, -2.2000])  # å«æ³¥é‡+1%ä¼šé™ä½å¼ºåº¦2.5 MPa
  water_binder_ratio: -8.5000 MPa (CI: [-9.2000, -7.8000])  # æ°´èƒ¶æ¯”+0.01ä¼šé™ä½å¼ºåº¦8.5 MPa
  mix_design_accuracy_pct: +0.3000 MPa (CI: [+0.2500, +0.3500])
```

**å†³ç­–å»ºè®®**ï¼š
- ä¼˜å…ˆæ§åˆ¶**æ°´èƒ¶æ¯”**ï¼ˆæ•ˆåº”æœ€å¤§ï¼‰
- é‡‡ç”¨**æ°´æ´—å·¥è‰º**é™ä½å«æ³¥é‡
- æé«˜é…åˆæ¯”å‡†ç¡®æ€§

#### æ­¥éª¤ 3ï¼šåäº‹å®åˆ†æ

**åœºæ™¯**ï¼šé’ˆå¯¹ä¸è¾¾æ ‡æ‰¹æ¬¡ï¼Œæ¨¡æ‹Ÿä¼˜åŒ–æ–¹æ¡ˆæ•ˆæœ

```bash
python concrete_counterfactual_demo.py
```

**è¾“å‡ºè§£è¯»**ï¼š
```
å®é™…è§‚æµ‹çš„æ‰¹æ¬¡:
  å«æ³¥é‡: 3.50%
  æ°´èƒ¶æ¯”: 0.48
  â†’ æ··å‡åœŸå¼ºåº¦: 28.5 MPa (ä¸è¾¾æ ‡)

åœºæ™¯1 (æ°´æ´—å·¥è‰º): 33.2 MPa (+4.7 MPa)
åœºæ™¯2 (ä¼˜åŒ–æ°´èƒ¶æ¯”): 31.8 MPa (+3.3 MPa)
åœºæ™¯3 (ç»¼åˆä¼˜åŒ–): 36.5 MPa (+8.0 MPa) â­ æ¨è

æ¨èè¡ŒåŠ¨æ–¹æ¡ˆ:
  âœ“ æœ€ä½³æ–¹æ¡ˆ: ç»¼åˆä¼˜åŒ–ç­–ç•¥
    é¢„æœŸæ•ˆæœ: å¼ºåº¦æå‡ 8.0 MPa
    ä¼˜åŒ–åå¼ºåº¦: 36.5 MPa (è¾¾æ ‡)
```

### åœºæ™¯äºŒï¼šå·¥ç¨‹æ£€æµ‹å› æœåˆ†æ

#### æ•°æ®å‡†å¤‡

ä½¿ç”¨å·¥ç¨‹æ£€æµ‹çœŸå®æ•°æ®ï¼ˆå·²æ¸…æ´—ï¼‰ï¼š
```python
# æ•°æ®è·¯å¾„ï¼šdata/processed/cleaned_data.csv
# åŒ…å«å˜é‡ï¼š
# - ææ–™ä¿¡æ¯ï¼šç”Ÿäº§å‚å®¶ã€å“ç§ã€å¼ºåº¦ç­‰çº§ã€è§„æ ¼
# - æ£€æµ‹ä¿¡æ¯ï¼šæ£€éªŒç±»åˆ«ã€é£é™©ç­‰çº§ã€ç»“æ„éƒ¨ä½
# - å‚ä¸æ–¹ï¼šæ–½å·¥å•ä½ã€ç›‘ç†å•ä½ã€å§”æ‰˜å•ä½
# - ç»“æœå˜é‡ï¼šæ˜¯å¦åˆæ ¼ã€ä»·æ ¼ã€æ£€æµ‹å‘¨æœŸ
```

#### è¿è¡Œåˆ†æ

```bash
cd engineering_inspection_analysis
python inspection_analysis_demo.py
```

**åˆ†ææµç¨‹**ï¼š
1. **æ•°æ®é¢„å¤„ç†**ï¼šç¼–ç åˆ†ç±»å˜é‡ã€è®¡ç®—å†å²åˆæ ¼ç‡
2. **å› æœå›¾æ„å»º**ï¼šåŸºäºæ£€æµ‹é¢†åŸŸçŸ¥è¯†å»ºç«‹å› æœå…³ç³»
3. **å½’å› åˆ†æ**ï¼šè¯†åˆ«åˆæ ¼ç‡å˜åŒ–çš„æ ¹æœ¬åŸå› 
4. **å¹²é¢„åˆ†æ**ï¼šè¯„ä¼°ä¼˜åŒ–æªæ–½ï¼ˆå¦‚æ›´æ¢å‚å®¶ã€æé«˜é£é™©ç­‰çº§ï¼‰
5. **åäº‹å®åˆ†æ**ï¼šé’ˆå¯¹ä¸åˆæ ¼æ ·æœ¬ï¼Œæ¨¡æ‹Ÿæ”¹è¿›æ–¹æ¡ˆ

#### è¾“å‡ºè§£è¯»

æŸ¥çœ‹ç”Ÿæˆçš„æŠ¥å‘Šï¼š
```bash
cat results/reports/analysis_summary.txt
```

**å…³é”®å‘ç°**ï¼š
```
1. ç”Ÿäº§å‚å®¶é€‰æ‹©å¯¹è´¨é‡å½±å“æœ€å¤§ï¼ˆè´¡çŒ®åº¦ -0.0097ï¼‰
2. å¼ºåº¦ç­‰çº§ç¼–ç æ¬¡ä¹‹ï¼ˆè´¡çŒ®åº¦ -0.0079ï¼‰
3. æ£€éªŒé£é™©ç­‰çº§ä¸ä¸åˆæ ¼ç‡å¯†åˆ‡ç›¸å…³

å»ºè®®:
  1. å»ºç«‹ç”Ÿäº§å‚å®¶è´¨é‡æ¡£æ¡ˆï¼Œä¼˜é€‰é«˜è´¨é‡ä¾›åº”å•†
  2. åŠ å¼ºæ–½å·¥å•ä½è´¨é‡ç®¡ç†åŸ¹è®­å’Œç›‘ç£
  3. åˆç†å®‰æ’æ£€éªŒè®¡åˆ’ï¼Œé¿å¼€é«˜å³°æœŸ
  4. é’ˆå¯¹å…³é”®ç»“æ„éƒ¨ä½åŠ å¼ºç›‘ç£æŠ½æ£€
```

---

## ğŸ”§ è¿›é˜¶ä½¿ç”¨

### è‡ªå®šä¹‰å› æœå›¾

ä¿®æ”¹ `src/causal_model.py` ä¸­çš„ `build_causal_graph()` æ–¹æ³•ï¼š

```python
def build_causal_graph(self):
    """æ„å»ºè‡ªå®šä¹‰å› æœå›¾"""
    G = nx.DiGraph()
    
    # æ·»åŠ èŠ‚ç‚¹
    G.add_node('your_treatment')
    G.add_node('your_outcome')
    G.add_node('confounder')
    
    # æ·»åŠ è¾¹ï¼ˆå› æœå…³ç³»ï¼‰
    G.add_edge('your_treatment', 'your_outcome')
    G.add_edge('confounder', 'your_treatment')
    G.add_edge('confounder', 'your_outcome')
    
    return G
```

### è°ƒæ•´åˆ†æå‚æ•°

åœ¨æ¼”ç¤ºè„šæœ¬ä¸­ä¿®æ”¹å‚æ•°ï¼š

```python
# å½’å› åˆ†æ
contributions, uncertainties = model.attribution_analysis(
    df_old=df_old,
    df_new=df_new,
    target_column='your_target',
    num_samples=2000,              # å¢åŠ æ ·æœ¬æ•°æé«˜ç²¾åº¦
    confidence_level=0.95,         # 95% ç½®ä¿¡åŒºé—´
    num_bootstrap_resamples=10     # å¢åŠ  bootstrap æ¬¡æ•°
)

# å¹²é¢„åˆ†æ
intervention_results = model.intervention_analysis(
    target='your_target',
    step_size=1.0,                 # å¹²é¢„æ­¥é•¿
    confidence_level=0.95,
    num_samples=5000,              # å¢åŠ æ ·æœ¬æ•°
    num_bootstrap_resamples=20
)
```

### ä½¿ç”¨è‡ªå·±çš„æ•°æ®

1. **å‡†å¤‡æ•°æ®**ï¼šCSV æ ¼å¼ï¼Œæ¯è¡Œä¸€ä¸ªæ ·æœ¬ï¼Œæ¯åˆ—ä¸€ä¸ªå˜é‡
2. **æ•°æ®æ¸…æ´—**ï¼šå¤„ç†ç¼ºå¤±å€¼ã€å¼‚å¸¸å€¼ã€ç¼–ç åˆ†ç±»å˜é‡
3. **æ„å»ºå› æœå›¾**ï¼šåŸºäºé¢†åŸŸçŸ¥è¯†å®šä¹‰å˜é‡é—´å› æœå…³ç³»
4. **è¿è¡Œåˆ†æ**ï¼šå‚è€ƒæ¼”ç¤ºè„šæœ¬ä¿®æ”¹ä»£ç 

```python
import pandas as pd
from src.causal_model import ConcreteAggregateCausalModel

# åŠ è½½æ•°æ®
df = pd.read_csv('your_data.csv')

# æ„å»ºæ¨¡å‹
model = ConcreteAggregateCausalModel(df)
causal_graph = model.build_causal_graph()  # éœ€ä¿®æ”¹ä¸ºè‡ªå®šä¹‰å› æœå›¾
model.fit_causal_model(quality='BETTER', invertible=True)

# è¿è¡Œåˆ†æ...
```

---

## ğŸ“Š è¾“å‡ºæ–‡ä»¶è¯´æ˜

### å›¾è¡¨æ–‡ä»¶ (results/figures/)

| æ–‡ä»¶å | è¯´æ˜ |
|--------|------|
| `concrete_causal_graph.png` | æ··å‡åœŸå› æœå›¾ï¼ˆæ˜¾ç¤ºå˜é‡é—´å› æœå…³ç³»ï¼‰ |
| `attribution_analysis_concrete.png` | å½’å› åˆ†æç»“æœï¼ˆæŸ±çŠ¶å›¾+ç½®ä¿¡åŒºé—´ï¼‰ |
| `intervention_analysis_concrete.png` | å¹²é¢„åˆ†æç»“æœï¼ˆæŸ±çŠ¶å›¾+ç½®ä¿¡åŒºé—´ï¼‰ |
| `concrete_counterfactual_analysis.png` | åäº‹å®åœºæ™¯å¯¹æ¯”å›¾ |
| `inspection_causal_graph.png` | æ£€æµ‹å› æœå›¾ |

### æŠ¥å‘Šæ–‡ä»¶ (results/reports/)

| æ–‡ä»¶å | è¯´æ˜ |
|--------|------|
| `analysis_summary_concrete.txt` | æ··å‡åœŸåˆ†ææ€»ç»“æŠ¥å‘Š |
| `attribution_results_concrete.csv` | å½’å› åˆ†æè¯¦ç»†æ•°æ®ï¼ˆå¯å¯¼å…¥Excelï¼‰ |
| `intervention_results_concrete.csv` | å¹²é¢„åˆ†æè¯¦ç»†æ•°æ® |
| `counterfactual_analysis_report.txt` | åäº‹å®åˆ†ææŠ¥å‘Š |

---

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **å› æœæ¨ç†**ï¼šDoWhy, EconML
- **æ·±åº¦å­¦ä¹ **ï¼šPyTorch (Normalizing Flow ç”¨äºåäº‹å®åˆ†æ)
- **æ•°æ®å¤„ç†**ï¼šPandas, NumPy, SciPy
- **æœºå™¨å­¦ä¹ **ï¼šScikit-learn, Statsmodels
- **å¯è§†åŒ–**ï¼šMatplotlib, Seaborn, NetworkX, Plotly
- **å¼€å‘å·¥å…·**ï¼šJupyter, tqdm

---

## ğŸ“š å‚è€ƒèµ„æ–™

### å› æœæ¨ç†ç†è®º
- Pearl, J. (2009). *Causality: Models, Reasoning, and Inference*
- Imbens, G. W., & Rubin, D. B. (2015). *Causal Inference for Statistics, Social, and Biomedical Sciences*

### å·¥å…·æ–‡æ¡£
- [DoWhy æ–‡æ¡£](https://www.pyfound.microsoft.com/dowhy/)
- [EconML æ–‡æ¡£](https://econml.azurewebsites.net/)
- [NetworkX æ–‡æ¡£](https://networkx.org/)

### åº”ç”¨æ¡ˆä¾‹
- Causal inference in machine learning (Google AI Blog)
- Industrial applications of causal ML (Uber, Netflix, Airbnb)

---

## â“ å¸¸è§é—®é¢˜ (FAQ)

### Q1: å½’å› åˆ†æå’Œå¹²é¢„åˆ†æçš„åŒºåˆ«ï¼Ÿ

**å½’å› åˆ†æ**ï¼šå›é¡¾æ€§ï¼Œè§£é‡Šå·²å‘ç”Ÿçš„å˜åŒ–
- "ä¸ºä»€ä¹ˆæ··å‡åœŸå¼ºåº¦æå‡äº†ï¼Ÿ" â†’ å› ä¸ºå«æ³¥é‡é™ä½äº†

**å¹²é¢„åˆ†æ**ï¼šå‰ç»æ€§ï¼Œé¢„æµ‹æœªæ¥çš„å¹²é¢„æ•ˆæœ
- "å¦‚æœé™ä½å«æ³¥é‡ï¼Œå¼ºåº¦ä¼šæå‡å¤šå°‘ï¼Ÿ" â†’ é¢„è®¡æå‡ 2.5 MPa

### Q2: åäº‹å®åˆ†æéœ€è¦å¯é€†æ¨¡å‹ï¼Œä¸ºä»€ä¹ˆï¼Ÿ

åäº‹å®åˆ†æéœ€è¦æ¨æ–­"æœªè§‚æµ‹åˆ°çš„æ½œåœ¨ç»“æœ"ï¼Œè¿™éœ€è¦ï¼š
1. ä»è§‚æµ‹æ•°æ®æ¨æ–­**å¤–ç”Ÿå™ªå£°** (abduction)
2. åœ¨å¹²é¢„æ¡ä»¶ä¸‹é‡æ–°ç”Ÿæˆç»“æœ (action + prediction)

å¯é€†æ¨¡å‹ï¼ˆNormalizing Flowï¼‰èƒ½å¤Ÿå®ç°åŒå‘æ˜ å°„ï¼š
```
è§‚æµ‹æ•°æ® â‡„ å¤–ç”Ÿå™ªå£°
```

### Q3: ç½®ä¿¡åŒºé—´ä¸ºä»€ä¹ˆåŒ…å« 0ï¼Ÿ

ç½®ä¿¡åŒºé—´åŒ…å« 0 è¡¨ç¤ºè¯¥å˜é‡çš„å› æœæ•ˆåº”**ç»Ÿè®¡ä¸æ˜¾è‘—**ï¼Œå¯èƒ½åŸå› ï¼š
- æ ·æœ¬é‡ä¸è¶³
- å˜é‡ä¸ç›®æ ‡å…³ç³»è¾ƒå¼±
- æ··æ‚å› ç´ æœªå……åˆ†æ§åˆ¶

**è§£å†³æ–¹æ³•**ï¼š
- å¢åŠ æ ·æœ¬æ•° (`num_samples`)
- å¢åŠ  bootstrap æ¬¡æ•° (`num_bootstrap_resamples`)
- æ£€æŸ¥å› æœå›¾æ˜¯å¦æ­£ç¡®

### Q4: å¦‚ä½•éªŒè¯å› æœåˆ†æç»“æœï¼Ÿ

1. **é¢†åŸŸä¸“å®¶éªŒè¯**ï¼šç»“æœæ˜¯å¦ç¬¦åˆä¸“ä¸šçŸ¥è¯†ï¼Ÿ
2. **æ•æ„Ÿæ€§åˆ†æ**ï¼šæ”¹å˜å‚æ•°/å‡è®¾ï¼Œç»“æœæ˜¯å¦ç¨³å®šï¼Ÿ
3. **éšæœºå¯¹ç…§è¯•éªŒï¼ˆRCTï¼‰**ï¼šåœ¨çœŸå®åœºæ™¯ä¸­éªŒè¯é¢„æµ‹
4. **äº¤å‰éªŒè¯**ï¼šåœ¨ä¸åŒæ•°æ®å­é›†ä¸ŠéªŒè¯ä¸€è‡´æ€§

### Q5: è¿è¡Œé€Ÿåº¦æ…¢æ€ä¹ˆåŠï¼Ÿ

**ä¼˜åŒ–å»ºè®®**ï¼š
- å‡å°‘æ ·æœ¬æ•°ï¼š`num_samples=1000` (é»˜è®¤ 5000)
- å‡å°‘ bootstrap æ¬¡æ•°ï¼š`num_bootstrap_resamples=5` (é»˜è®¤ 20)
- ä½¿ç”¨éå¯é€†æ¨¡å‹ï¼š`invertible=False` (å½’å› /å¹²é¢„åˆ†ææ—¶)
- ç²¾ç®€å˜é‡ï¼šåªä¿ç•™å…³é”®å˜é‡

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

### å¼€å‘æµç¨‹
1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ï¼š`git checkout -b feature/your-feature`
3. æäº¤æ›´æ”¹ï¼š`git commit -m 'Add your feature'`
4. æ¨é€åˆ†æ”¯ï¼š`git push origin feature/your-feature`
5. æäº¤ Pull Request

### ä»£ç è§„èŒƒ
- éµå¾ª PEP 8 ä»£ç é£æ ¼
- æ·»åŠ å¿…è¦çš„æ–‡æ¡£å­—ç¬¦ä¸²
- ç¼–å†™å•å…ƒæµ‹è¯•ï¼ˆä½¿ç”¨ pytestï¼‰

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

---

## ğŸ‘¥ ä½œè€…ä¸è”ç³»æ–¹å¼

**ä½œè€…**ï¼šæ²ˆåº·
**åº”ç”¨é¢†åŸŸ**ï¼šå…¬è·¯å·¥ç¨‹é›†æ–™æ£€æµ‹ã€æ··å‡åœŸè´¨é‡æ§åˆ¶

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿è”ç³»ï¼

---

## ğŸ¯ æœªæ¥è®¡åˆ’

- [ ] æ·»åŠ æ›´å¤šå·¥ä¸šåœºæ™¯æ¡ˆä¾‹ï¼ˆé’¢ç­‹ã€æ²¥é’ã€åœŸå·¥ç­‰ï¼‰
- [ ] æ”¯æŒæ—¶é—´åºåˆ—å› æœåˆ†æ
- [ ] å¼€å‘ Web ç•Œé¢ï¼ˆStreamlit/Dashï¼‰
- [ ] é›†æˆ AutoML è‡ªåŠ¨é€‰æ‹©å› æœæ¨¡å‹
- [ ] æ”¯æŒå¤šç›®æ ‡ä¼˜åŒ–ï¼ˆå¦‚è´¨é‡+æˆæœ¬+æ—¶é—´ï¼‰
- [ ] å¼€å‘å› æœçŸ¥è¯†å›¾è°±å¯è§†åŒ–å·¥å…·

---

## â­ Star History

å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸€ä¸ª â­ï¸ Starï¼

---

**æœ€åæ›´æ–°æ—¶é—´**ï¼š2025-11-04
